"use strict";var myMap,hamburger=document.querySelector(".hamburger"),menu=document.querySelector(".menu");hamburger.addEventListener("click",function(e){e.preventDefault(),menu.classList.toggle("menu--active"),hamburger.classList.toggle("hamburger--active")}),function(){function i(e){var t=e.find(".assortment-menu__item"),e=e.find(".assortment-menu__content");t.removeClass("assortment-menu__item--active"),e.width(0)}function r(e){var t=0,n=$(window).width(),o=3*e.find(".assortment-menu__title").width(),a=e.find(".assortment-menu__container"),i=parseInt(a.css("padding-left")),r=parseInt(a.css("padding-right")),s=window.matchMedia("(max-width: 768px)").matches,a=window.matchMedia("(max-width: 480px)").matches;return s&&(t=n-o),a&&(t=n-e.find(".assortment-menu__title").width()),{container:t=!s&&!a?500:t,textContainer:t-i-r}}$(".assortment-menu__title").click(function(e){e.preventDefault();var t=$(e.currentTarget),n=t.closest(".assortment-menu__item"),o=n.hasClass("assortment-menu__item--active"),a=t.closest(".assortment-menu");o?i(a):(i(a),t=(e=n).find(".assortment-menu__content"),o=r(e).container,a=e.find(".assortment-menu__container"),n=r(e).textContainer,e.addClass("assortment-menu__item--active"),t.width(o),a.width(n))}),$(".assortment-menu__close").click(function(e){e.preventDefault(),i($(".assortment-menu"))})}();var init=function(){myMap=new ymaps.Map("map",{center:[51.530777,46.035694],zoom:11,controls:[]});for(var e=[[51.550777,46.055694],[51.540777,46.075694],[51.530777,46.045694],[51.479213,46.085694]],t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/decor/marker.png",iconImageSize:[46,57],iconImageOffset:[-35,-52]}),n=0;n<e.length;n++)t.add(new ymaps.Placemark(e[n]));myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")};ymaps.ready(init);var validateForm=function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length};$(".form").submit(function(e){e.preventDefault();var t=$(e.currentTarget),n=t.find("[name='name']"),o=t.find("[name='phone']"),a=t.find("[name='comment']"),e=t.find("[name='to']"),i=$("#modal"),r=i.find(".modal__content");i.removeClass("error-modal"),validateForm(t,[n,o,a,e])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:n.val(),phone:o.val(),comment:a.val(),to:e.val()}})).done(function(e){r.text(e.message)}),e.fail(function(e){e=e.responseJSON.message;r.text(e),i.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".js-submit-btn").click(function(e){e.preventDefault(),$.fancybox.close()});var sections=$("section"),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1;sections.first().addClass("active");var durationControl,soundControl,intervalId,countSectionPosition=function(e){e*=-100;return isNaN(e)?(console.error("передано не верное значение в countSectionPosition"),0):e},changeMenuThemeForSection=function(e){var t="fixed-menu--shadowed";"black"===sections.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass(t):sideMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),resetActiveClassForItem(menuItems,e,"fixed-menu__item--active"),setTimeout(function(){inScroll=!1},1300))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}};$(window).on("wheel",function(e){var t=e.originalEvent.deltaY,e=viewportScroller();0<t&&e.next(),t<0&&e.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewportScroller();if(!t)switch(e.keyCode){case 38:n.prev();break;case 40:n.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"===t?"prev":"up"===t?"next":""]()}});var video,playBtn=document.querySelector(".video__player-img"),soundBtn=document.querySelector(".sound"),playerPlayBtn=document.querySelector(".duration__img");(video=document.getElementById("player")).addEventListener("click",playStop);for(var playButtons=document.querySelectorAll(".play"),i=0;i<playButtons.length;i++)playButtons[i].addEventListener("click",playStop);var micControl=document.getElementById("mic");function playStop(){playBtn.classList.toggle("video__player-img--active"),video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/60),playerPlayBtn.classList.add("active")):(video.pause(),clearInterval(intervalId),playerPlayBtn.classList.remove("active"))}function setVideoDuration(){video.currentTime=durationControl.value,updateDuration()}function updateDuration(){durationControl.value=video.currentTime;var e=video.duration/100,e=video.currentTime/e;durationControl.style.background="linear-gradient(90deg, #E01F3D 0%, #E01F3D ".concat(e,"%, #333333 ").concat(e,"%)")}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel,soundBtn.classList.remove("active")):(soundLevel=video.volume,video.volume=0,soundControl.value=0,soundBtn.classList.add("active"))}function changeSoundVolume(){video.volume=soundControl.value/10,0==video.volume?soundBtn.classList.add("active"):soundBtn.classList.remove("active"),console.log("значение volume у видео "+video.volume),console.log("значение value у micLevel "+soundControl.value/10)}micControl.addEventListener("click",soundOf),(durationControl=document.getElementById("durationLevel")).addEventListener("input",setVideoDuration),durationControl.min=0,durationControl.value=0,durationControl.max=video.duration,(soundControl=document.getElementById("micLevel")).addEventListener("input",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max,video.addEventListener("ended",function(){playBtn.classList.toggle("video__player-img--active"),video.currentTime=0,playerPlayBtn.classList.remove("active")});var findBlockByAlias=function(n){return $(".rewiews__item").filter(function(e,t){return $(t).attr("data-link")==n})};$(".interactive-avatar").click(function(e){e.preventDefault();var t=$(e.currentTarget),e=t.attr("data-open"),e=findBlockByAlias(e),t=t.closest(".rewiews__switcher-item");e.addClass("rewiews__item--active").siblings().removeClass("rewiews__item--active"),t.addClass("interactive-avatar--active").siblings().removeClass("interactive-avatar--active")});var slider=$(".slider__list").bxSlider({pager:!1,controls:!1});$(".slider__button--prev").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".slider__button--next").click(function(e){e.preventDefault(),slider.goToNextSlide()});var openItem=function(e){var t=e.closest(".team__item"),n=t.find(".team__content"),e=n.find(".team__content-block").height();t.addClass("active"),n.height(e)},closeEveryItem=function(e){var t=e.find(".team__content");e.find(".team__item").removeClass("active"),t.height(0)};$(".team__name").click(function(e){e.preventDefault();var t=$(e.currentTarget),e=t.closest(".team");t.closest(".team__item").hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZ1bGxzY3JlZW4tbWVudS5qcyIsIm1hcC5qcyIsImhvcml6b250YWwtYWNjby5qcyIsIm1vZGFsLmpzIiwib3BzLmpzIiwicGxheWVyLmpzIiwicmV3aWV3cy5qcyIsInNsaWRlci5qcyIsInRlYW0uanMiXSwibmFtZXMiOlsibXlNYXAiLCJoYW1idXJnZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIiLCJjb250YWluZXIiLCJpdGVtcyIsImZpbmQiLCJjb250ZW50IiwicmVtb3ZlQ2xhc3MiLCJ3aWR0aCIsIm1lYXN1cmVXaWR0aCIsImJsb2NrIiwiaXRlbVdpZHRoIiwic2NyZWVuV2lkdGgiLCIkIiwid2luZG93IiwidGl0bGVzV2lkdGgiLCJ0ZXh0Q29udGFpbmVyIiwicGFkZGluZ0xlZnQiLCJwYXJzZUludCIsImNzcyIsInBhZGRpbmdSaWdodCIsImlzVGFibGV0IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJpc01vYmlsZSIsImNsaWNrIiwiJHRoaXMiLCJjdXJyZW50VGFyZ2V0IiwiaXRlbSIsImNsb3Nlc3QiLCJpdGVtT3BlbmVkIiwiaGFzQ2xhc3MiLCJoaWRkZW5CbG9jayIsInJlcVdpZHRoIiwidGV4dEJsb2NrIiwidGV4dEJsb2NrV2lkdGgiLCJhZGRDbGFzcyIsImluaXQiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJjb250cm9scyIsImNvb3JkcyIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJpIiwibGVuZ3RoIiwiYWRkIiwiUGxhY2VtYXJrIiwiZ2VvT2JqZWN0cyIsImJlaGF2aW9ycyIsImRpc2FibGUiLCJyZWFkeSIsInZhbGlkYXRlRm9ybSIsImZvcm0iLCJmaWVsZHNBcnJheSIsImZvckVhY2giLCJmaWVsZCIsInZhbCIsInRyaW0iLCJzdWJtaXQiLCJuYW1lIiwicGhvbmUiLCJjb21tZW50IiwidG8iLCJtb2RhbCIsInJlcXVlc3QiLCJhamF4IiwidXJsIiwibWV0aG9kIiwiZGF0YSIsImRvbmUiLCJ0ZXh0IiwibWVzc2FnZSIsImZhaWwiLCJyZXNwb25zZUpTT04iLCJhbHdheXMiLCJmYW5jeWJveCIsIm9wZW4iLCJzcmMiLCJ0eXBlIiwiY2xvc2UiLCJzZWN0aW9ucyIsImRpc3BsYXkiLCJzaWRlTWVudSIsIm1lbnVJdGVtcyIsIm1vYmlsZURldGVjdCIsIk1vYmlsZURldGVjdCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm1vYmlsZSIsImluU2Nyb2xsIiwiZmlyc3QiLCJkdXJhdGlvbkNvbnRyb2wiLCJzb3VuZENvbnRyb2wiLCJpbnRlcnZhbElkIiwiY291bnRTZWN0aW9uUG9zaXRpb24iLCJzZWN0aW9uRXEiLCJwb3NpdGlvbiIsImlzTmFOIiwiY29uc29sZSIsImVycm9yIiwiY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiIsImFjdGl2ZUNsYXNzIiwiZXEiLCJhdHRyIiwicmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0iLCJpdGVtRXEiLCJzaWJsaW5ncyIsInBlcmZvcm1UcmFuc2l0aW9uIiwidHJhbnNmb3JtIiwiY29uY2F0Iiwic2V0VGltZW91dCIsInRyYW5zaXRpb25PdmVyIiwidmlld3BvcnRTY3JvbGxlciIsImFjdGl2ZVNlY3Rpb24iLCJmaWx0ZXIiLCJuZXh0U2VjdGlvbiIsIm5leHQiLCJwcmV2U2VjdGlvbiIsInByZXYiLCJpbmRleCIsIm9uIiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsInNjcm9sbGVyIiwidGFnTmFtZSIsInRhcmdldCIsInRvTG93ZXJDYXNlIiwidXNlclR5cGluZ0luSW5wdXRzIiwia2V5Q29kZSIsInJlcVNlY3Rpb24iLCJzd2lwZSIsImV2ZW50IiwiZGlyZWN0aW9uIiwidmlkZW8iLCJwbGF5QnRuIiwic291bmRCdG4iLCJwbGF5ZXJQbGF5QnRuIiwiZ2V0RWxlbWVudEJ5SWQiLCJwbGF5U3RvcCIsInBsYXlCdXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsIm1pY0NvbnRyb2wiLCJwYXVzZWQiLCJwbGF5Iiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGVEdXJhdGlvbiIsInBhdXNlIiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZSIsInNldFZpZGVvRHVyYXRpb24iLCJjdXJyZW50VGltZSIsInZhbHVlIiwic3RlcCIsImR1cmF0aW9uIiwicGVyY2VudCIsInN0eWxlIiwiYmFja2dyb3VuZCIsInNvdW5kT2YiLCJ2b2x1bWUiLCJzb3VuZExldmVsIiwiY2hhbmdlU291bmRWb2x1bWUiLCJsb2ciLCJtaW4iLCJtYXgiLCJmaW5kQmxvY2tCeUFsaWFzIiwiYWxpYXMiLCJuZHgiLCJjdXJyZW50IiwiaXRlbVRvU2hvdyIsImN1ckl0ZW0iLCJzbGlkZXIiLCJieFNsaWRlciIsInBhZ2VyIiwiZ29Ub1ByZXZTbGlkZSIsImdvVG9OZXh0U2xpZGUiLCJvcGVuSXRlbSIsImNvbnRlbnRCbG9jayIsInJlcUhlaWdodCIsImhlaWdodCIsImNsb3NlRXZlcnlJdGVtIl0sIm1hcHBpbmdzIjoiYUFBQSxJQ0FBQSxNREFBQyxVQUFBQyxTQUFBQyxjQUFBLGNBQ0FDLEtBQUFGLFNBQUFDLGNBQUEsU0FFQUYsVUFBQUksaUJBQUEsUUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxpQkFVQUgsS0FBQUksVUFBQUMsT0FBQSxnQkFDQVIsVUFBQU8sVUFBQUMsT0FBQSx1QkVmQSxXQUNBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUUsS0FBQSwwQkFDQUMsRUFBQUgsRUFBQUUsS0FBQSw2QkFFQUQsRUFBQUcsWUFBQSxpQ0FDQUQsRUFBQUUsTUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQSxFQUVBQyxFQUFBQyxFQUFBQyxRQUFBTixRQUNB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QUFBeUIsRUFBQUMsUUFBQSxlQUNBMkosRUFBQXJMLEVBQUFFLEtBQUEsa0JBRUFvTCxFQURBRCxFQUFBbkwsS0FBQSx3QkFDQXFMLFNBRUF2TCxFQUFBaUMsU0FBQSxVQUNBb0osRUFBQUUsT0FBQUQsSUFHQUUsZUFBQSxTQUFBeEwsR0FDQSxJQUFBQyxFQUFBRCxFQUFBRSxLQUFBLGtCQUNBRixFQUFBRSxLQUFBLGVBRUFFLFlBQUEsVUFDQUgsRUFBQXNMLE9BQUEsSUFHQTdLLEVBQUEsZUFBQVksTUFBQSxTQUFBM0IsR0FDQUEsRUFBQUMsaUJBQ0EsSUFBQTJCLEVBQUFiLEVBQUFmLEVBQUE2QixlQUNBeEIsRUFBQXVCLEVBQUFHLFFBQUEsU0FDQUgsRUFBQUcsUUFBQSxlQUVBRSxTQUFBLFVBQ0E0SixlQUFBeEwsSUFFQXdMLGVBQUF4TCxHQUNBb0wsU0FBQTdKIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBoYW1idXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFtYnVyZ2VyJyk7XHJcbmNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnVcIik7XHJcblxyXG5oYW1idXJnZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIC8vIGlmIChoYW1idXJnZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaGFtYnVyZ2VyLS1hY3RpdmVcIikpIHtcclxuICAgIC8vICAgICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJtZW51LS1hY3RpdmVcIik7XHJcbiAgICAvLyAgICAgaGFtYnVyZ2VyLmNsYXNzTGlzdC5yZW1vdmUoXCJoYW1idXJnZXItLWFjdGl2ZVwiKTtcclxuICAgIC8vIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgbWVudS5jbGFzc0xpc3QuYWRkKFwibWVudS0tYWN0aXZlXCIpO1xyXG4gICAgLy8gICAgIGhhbWJ1cmdlci5jbGFzc0xpc3QuYWRkKFwiaGFtYnVyZ2VyLS1hY3RpdmVcIik7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKFwibWVudS0tYWN0aXZlXCIpO1xyXG4gICAgaGFtYnVyZ2VyLmNsYXNzTGlzdC50b2dnbGUoXCJoYW1idXJnZXItLWFjdGl2ZVwiKTtcclxufSk7XHJcbiIsImxldCBteU1hcDtcclxuY29uc3QgaW5pdCA9ICgpID0+IHtcclxuICAgIG15TWFwID0gbmV3IHltYXBzLk1hcChcIm1hcFwiLCB7XHJcbiAgICAgICAgY2VudGVyOiBbNTEuNTMwNzc3LCA0Ni4wMzU2OTRdLFxyXG4gICAgICAgIHpvb206IDExLFxyXG4gICAgICAgIGNvbnRyb2xzOiBbXSxcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb29yZHMgPSBbXHJcbiAgICAgICAgWzUxLjU1MDc3NywgNDYuMDU1Njk0XSxcclxuICAgICAgICBbNTEuNTQwNzc3LCA0Ni4wNzU2OTRdLFxyXG4gICAgICAgIFs1MS41MzA3NzcsIDQ2LjA0NTY5NF0sXHJcbiAgICAgICAgWzUxLjQ3OTIxMywgNDYuMDg1Njk0XSxcclxuICAgIF0sXHJcbiAgICAgICAgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oe30sIHtcclxuICAgICAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxyXG4gICAgICAgICAgICBpY29uSW1hZ2VIcmVmOiAnLi9pbWcvZGVjb3IvbWFya2VyLnBuZycsXHJcbiAgICAgICAgICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddLFxyXG4gICAgICAgICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMzUsIC01Ml1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIG15Q29sbGVjdGlvbi5hZGQobmV3IHltYXBzLlBsYWNlbWFyayhjb29yZHNbaV0pKTtcclxuICAgIH1cclxuXHJcbiAgICBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pO1xyXG5cclxuICAgIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XHJcbn07XHJcblxyXG55bWFwcy5yZWFkeShpbml0KTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgY29uc3QgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciA9IChjb250YWluZXIpID0+IHtcclxuICAgICAgICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLmFzc29ydG1lbnQtbWVudV9faXRlbVwiKTtcclxuICAgICAgICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIuYXNzb3J0bWVudC1tZW51X19jb250ZW50XCIpO1xyXG5cclxuICAgICAgICBpdGVtcy5yZW1vdmVDbGFzcyhcImFzc29ydG1lbnQtbWVudV9faXRlbS0tYWN0aXZlXCIpO1xyXG4gICAgICAgIGNvbnRlbnQud2lkdGgoMCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG1lYXN1cmVXaWR0aCA9IChibG9jaykgPT4ge1xyXG4gICAgICAgIGxldCBpdGVtV2lkdGggPSAwO1xyXG5cclxuICAgICAgICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xyXG4gICAgICAgIGNvbnN0IHRpdGxlc1dpZHRoID0gYmxvY2suZmluZChcIi5hc3NvcnRtZW50LW1lbnVfX3RpdGxlXCIpLndpZHRoKCkgKiAzO1xyXG4gICAgICAgIGNvbnN0IHRleHRDb250YWluZXIgPSBibG9jay5maW5kKFwiLmFzc29ydG1lbnQtbWVudV9fY29udGFpbmVyXCIpO1xyXG4gICAgICAgIGNvbnN0IHBhZGRpbmdMZWZ0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLWxlZnRcIikpO1xyXG4gICAgICAgIGNvbnN0IHBhZGRpbmdSaWdodCA9IHBhcnNlSW50KHRleHRDb250YWluZXIuY3NzKFwicGFkZGluZy1yaWdodFwiKSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzVGFibGV0ID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA3NjhweClcIikubWF0Y2hlcztcclxuICAgICAgICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNDgwcHgpXCIpLm1hdGNoZXM7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGlzVGFibGV0KSB7XHJcbiAgICAgICAgICAgIGl0ZW1XaWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzV2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc01vYmlsZSkge1xyXG4gICAgICAgICAgICBpdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIGJsb2NrLmZpbmQoXCIuYXNzb3J0bWVudC1tZW51X190aXRsZVwiKS53aWR0aCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzVGFibGV0ICYmICFpc01vYmlsZSkge1xyXG4gICAgICAgICAgICBpdGVtV2lkdGggPSA1MDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb250YWluZXI6IGl0ZW1XaWR0aCxcclxuICAgICAgICAgICAgdGV4dENvbnRhaW5lcjogaXRlbVdpZHRoIC0gcGFkZGluZ0xlZnQgLSBwYWRkaW5nUmlnaHRcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG9wZW5JdGVtID0gKGl0ZW0pID0+IHtcclxuICAgICAgICBjb25zdCBoaWRkZW5CbG9jayA9IGl0ZW0uZmluZChcIi5hc3NvcnRtZW50LW1lbnVfX2NvbnRlbnRcIik7XHJcbiAgICAgICAgY29uc3QgcmVxV2lkdGggPSBtZWFzdXJlV2lkdGgoaXRlbSkuY29udGFpbmVyO1xyXG4gICAgICAgIGNvbnN0IHRleHRCbG9jayA9IGl0ZW0uZmluZChcIi5hc3NvcnRtZW50LW1lbnVfX2NvbnRhaW5lclwiKTtcclxuICAgICAgICBjb25zdCB0ZXh0QmxvY2tXaWR0aCA9IG1lYXN1cmVXaWR0aChpdGVtKS50ZXh0Q29udGFpbmVyO1xyXG5cclxuICAgICAgICBpdGVtLmFkZENsYXNzKFwiYXNzb3J0bWVudC1tZW51X19pdGVtLS1hY3RpdmVcIik7XHJcbiAgICAgICAgaGlkZGVuQmxvY2sud2lkdGgocmVxV2lkdGgpO1xyXG4gICAgICAgIHRleHRCbG9jay53aWR0aCh0ZXh0QmxvY2tXaWR0aClcclxuICAgIH07XHJcblxyXG4gICAgJChcIi5hc3NvcnRtZW50LW1lbnVfX3RpdGxlXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5hc3NvcnRtZW50LW1lbnVfX2l0ZW1cIik7XHJcbiAgICAgICAgY29uc3QgaXRlbU9wZW5lZCA9IGl0ZW0uaGFzQ2xhc3MoXCJhc3NvcnRtZW50LW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLmFzc29ydG1lbnQtbWVudVwiKTtcclxuXHJcbiAgICAgICAgaWYgKGl0ZW1PcGVuZWQpIHtcclxuICAgICAgICAgICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgb3Blbkl0ZW0oaXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJChcIi5hc3NvcnRtZW50LW1lbnVfX2Nsb3NlXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKCQoJy5hc3NvcnRtZW50LW1lbnUnKSk7XHJcbiAgICB9KTtcclxufSgpKTsiLCJjb25zdCB2YWxpZGF0ZUZvcm0gPSAoZm9ybSwgZmllbGRzQXJyYXkpID0+IHtcclxuXHJcbiAgICBmaWVsZHNBcnJheS5mb3JFYWNoKChmaWVsZCkgPT4ge1xyXG4gICAgICAgIGZpZWxkLnJlbW92ZUNsYXNzKFwiaW5wdXQtZXJyb3JcIik7XHJcbiAgICAgICAgaWYgKGZpZWxkLnZhbCgpLnRyaW0oKSA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGZpZWxkLmFkZENsYXNzKFwiaW5wdXQtZXJyb3JcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgZXJyb3JGaWVsZCA9IGZvcm0uZmluZChcIi5pbnB1dC1lcnJvclwiKTtcclxuXHJcbiAgICByZXR1cm4gZXJyb3JGaWVsZC5sZW5ndGggPT0gMDtcclxufVxyXG5cclxuJChcIi5mb3JtXCIpLnN1Ym1pdChlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcblxyXG4gICAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xyXG4gICAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoXCJbbmFtZT0ncGhvbmUnXVwiKTtcclxuICAgIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xyXG4gICAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcclxuXHJcbiAgICBjb25zdCBtb2RhbCA9ICQoXCIjbW9kYWxcIik7XHJcbiAgICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTtcclxuXHJcbiAgICBtb2RhbC5yZW1vdmVDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xyXG5cclxuICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZvcm0oZm9ybSwgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10pO1xyXG5cclxuXHJcblxyXG4gICAgaWYgKGlzVmFsaWQpIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcclxuICAgICAgICAgICAgICAgIHRvOiB0by52YWwoKSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmVxdWVzdC5kb25lKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICBjb250ZW50LnRleHQoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmVxdWVzdC5mYWlsKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLnJlc3BvbnNlSlNPTi5tZXNzYWdlO1xyXG4gICAgICAgICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XHJcbiAgICAgICAgICAgIG1vZGFsLmFkZENsYXNzKFwiZXJyb3ItbW9kYWxcIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcclxuICAgICAgICAgICAgJC5mYW5jeWJveC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIHNyYzogXCIjbW9kYWxcIixcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiaW5saW5lXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbiQoXCIuanMtc3VibWl0LWJ0blwiKS5jbGljaygoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICQuZmFuY3lib3guY2xvc2UoKTtcclxufSk7IiwiY29uc3Qgc2VjdGlvbnMgPSAkKFwic2VjdGlvblwiKTtcclxuY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbmNvbnRlbnRcIik7XHJcbmNvbnN0IHNpZGVNZW51ID0gJChcIi5maXhlZC1tZW51XCIpO1xyXG5jb25zdCBtZW51SXRlbXMgPSBzaWRlTWVudS5maW5kKFwiLmZpeGVkLW1lbnVfX2l0ZW1cIik7XHJcblxyXG5jb25zdCBtb2JpbGVEZXRlY3QgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxuY29uc3QgaXNNb2JpbGUgPSBtb2JpbGVEZXRlY3QubW9iaWxlKCk7XHJcblxyXG5sZXQgaW5TY3JvbGwgPSBmYWxzZTtcclxuXHJcbnNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG5jb25zdCBjb3VudFNlY3Rpb25Qb3NpdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcclxuICAgIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxICogLTEwMDtcclxuXHJcbiAgICBpZiAoaXNOYU4ocG9zaXRpb24pKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcItC/0LXRgNC10LTQsNC90L4g0L3QtSDQstC10YDQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQsiBjb3VudFNlY3Rpb25Qb3NpdGlvblwiKTtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcG9zaXRpb247XHJcbn07XHJcblxyXG5jb25zdCBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xyXG4gICAgY29uc3QgbWVudVRoZW1lID0gY3VycmVudFNlY3Rpb24uYXR0cihcImRhdGEtc2lkZW1lbnUtdGhlbWVcIik7XHJcbiAgICBjb25zdCBhY3RpdmVDbGFzcyA9IFwiZml4ZWQtbWVudS0tc2hhZG93ZWRcIjtcclxuXHJcbiAgICBpZiAobWVudVRoZW1lID09PSBcImJsYWNrXCIpIHtcclxuICAgICAgICBzaWRlTWVudS5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtID0gKGl0ZW1zLCBpdGVtRXEsIGFjdGl2ZUNsYXNzKSA9PiB7XHJcbiAgICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gICAgaWYgKGluU2Nyb2xsKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgdHJhbnNpdGlvbk92ZXIgPSAxMDAwO1xyXG4gICAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDMwMDtcclxuXHJcbiAgICBpblNjcm9sbCA9IHRydWU7XHJcblxyXG4gICAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xyXG5cclxuICAgIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgICBkaXNwbGF5LmNzcyh7XHJcbiAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYCxcclxuICAgIH0pO1xyXG5cclxuICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKHNlY3Rpb25zLCBzZWN0aW9uRXEsIFwiYWN0aXZlXCIpO1xyXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0obWVudUl0ZW1zLCBzZWN0aW9uRXEsIFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcbiAgICB9LCB0cmFuc2l0aW9uT3ZlciArIG1vdXNlSW5lcnRpYU92ZXIpO1xyXG59O1xyXG5cclxuY29uc3Qgdmlld3BvcnRTY3JvbGxlciA9ICgpID0+IHtcclxuICAgIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xyXG4gICAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcclxuICAgIGNvbnN0IHByZXZTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5wcmV2KCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0KCkge1xyXG4gICAgICAgICAgICBpZiAobmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJldigpIHtcclxuICAgICAgICAgICAgaWYgKHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfTtcclxufTtcclxuXHJcbiQod2luZG93KS5vbihcIndoZWVsXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcblxyXG4gICAgaWYgKGRlbHRhWSA+IDApIHtcclxuICAgICAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRlbHRhWSA8IDApIHtcclxuICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuJCh3aW5kb3cpLm9uKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgY29uc3QgdGFnTmFtZSA9IGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHVzZXJUeXBpbmdJbklucHV0cyA9IHRhZ05hbWUgPT09IFwiaW5wdXRcIiB8fCB0YWdOYW1lID09PSBcInRleHRhcmVhXCI7XHJcbiAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgICBpZiAodXNlclR5cGluZ0luSW5wdXRzKSByZXR1cm47XHJcblxyXG4gICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgICAgICBjYXNlIDM4OlxyXG4gICAgICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlIDQwOlxyXG4gICAgICAgICAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbiQoXCIud3JhcHBlclwiKS5vbihcInRvdWNobW92ZVwiLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcclxuXHJcbiQoXCJbZGF0YS1zY3JvbGwtdG9dXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XHJcbiAgICBjb25zdCByZXFTZWN0aW9uID0gJChgW2RhdGEtc2VjdGlvbi1pZD0ke3RhcmdldH1dYCk7XHJcblxyXG4gICAgcGVyZm9ybVRyYW5zaXRpb24ocmVxU2VjdGlvbi5pbmRleCgpKTtcclxufSk7XHJcblxyXG5pZiAoaXNNb2JpbGUpIHtcclxuICAgICQoXCJib2R5XCIpLnN3aXBlKHtcclxuICAgICAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcbiAgICAgICAgICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJ1cFwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcIm5leHRcIjtcclxuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJkb3duXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwicHJldlwiO1xyXG5cclxuICAgICAgICAgICAgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxufSIsImxldCB2aWRlbztcclxubGV0IGR1cmF0aW9uQ29udHJvbDtcclxubGV0IHNvdW5kQ29udHJvbDtcclxubGV0IGludGVydmFsSWQ7XHJcblxyXG5jb25zdCBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi52aWRlb19fcGxheWVyLWltZ1wiKTtcclxuY29uc3Qgc291bmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNvdW5kXCIpO1xyXG5jb25zdCBwbGF5ZXJQbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kdXJhdGlvbl9faW1nXCIpO1xyXG5cclxuXHJcbnZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIik7XHJcblxyXG5cclxudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5U3RvcCk7XHJcblxyXG5sZXQgcGxheUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBsYXlcIik7XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgcGxheUJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgIHBsYXlCdXR0b25zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheVN0b3ApO1xyXG59XHJcblxyXG5sZXQgbWljQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWljXCIpO1xyXG5taWNDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc291bmRPZik7XHJcblxyXG5kdXJhdGlvbkNvbnRyb2wgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImR1cmF0aW9uTGV2ZWxcIik7XHJcbmR1cmF0aW9uQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHNldFZpZGVvRHVyYXRpb24pO1xyXG5cclxuZHVyYXRpb25Db250cm9sLm1pbiA9IDA7XHJcbmR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IDA7XHJcbmR1cmF0aW9uQ29udHJvbC5tYXggPSB2aWRlby5kdXJhdGlvbjtcclxuXHJcbnNvdW5kQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWljTGV2ZWxcIik7XHJcbnNvdW5kQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGNoYW5nZVNvdW5kVm9sdW1lKTtcclxuXHJcbnNvdW5kQ29udHJvbC5taW4gPSAwO1xyXG5zb3VuZENvbnRyb2wubWF4ID0gMTA7XHJcbnNvdW5kQ29udHJvbC52YWx1ZSA9IHNvdW5kQ29udHJvbC5tYXg7XHJcblxyXG5cclxudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJ2aWRlb19fcGxheWVyLWltZy0tYWN0aXZlXCIpO1xyXG4gICAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xyXG4gICAgcGxheWVyUGxheUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxufSk7XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHBsYXlTdG9wKCkge1xyXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwidmlkZW9fX3BsYXllci1pbWctLWFjdGl2ZVwiKTtcclxuXHJcblxyXG4gICAgaWYgKHZpZGVvLnBhdXNlZCkge1xyXG4gICAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgICAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodXBkYXRlRHVyYXRpb24sIDEwMDAgLyA2MCk7XHJcbiAgICAgICAgcGxheWVyUGxheUJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmlkZW8ucGF1c2UoKTtcclxuICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsSWQpO1xyXG4gICAgICAgIHBsYXllclBsYXlCdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFZpZGVvRHVyYXRpb24oKSB7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IGR1cmF0aW9uQ29udHJvbC52YWx1ZTtcclxuICAgIHVwZGF0ZUR1cmF0aW9uKCk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiB1cGRhdGVEdXJhdGlvbigpIHtcclxuICAgIGR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IHZpZGVvLmN1cnJlbnRUaW1lO1xyXG4gICAgbGV0IHN0ZXAgPSB2aWRlby5kdXJhdGlvbiAvIDEwMDtcclxuICAgIGxldCBwZXJjZW50ID0gdmlkZW8uY3VycmVudFRpbWUgLyBzdGVwO1xyXG4gICAgZHVyYXRpb25Db250cm9sLnN0eWxlLmJhY2tncm91bmQgPSBgbGluZWFyLWdyYWRpZW50KDkwZGVnLCAjRTAxRjNEIDAlLCAjRTAxRjNEICR7cGVyY2VudH0lLCAjMzMzMzMzICR7cGVyY2VudH0lKWA7XHJcblxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gc291bmRPZigpIHtcclxuICAgIGlmICh2aWRlby52b2x1bWUgPT09IDApIHtcclxuICAgICAgICB2aWRlby52b2x1bWUgPSBzb3VuZExldmVsO1xyXG4gICAgICAgIHNvdW5kQ29udHJvbC52YWx1ZSA9IHNvdW5kTGV2ZWwgKiAxMDtcclxuICAgICAgICBzb3VuZEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc291bmRMZXZlbCA9IHZpZGVvLnZvbHVtZTtcclxuICAgICAgICB2aWRlby52b2x1bWUgPSAwO1xyXG4gICAgICAgIHNvdW5kQ29udHJvbC52YWx1ZSA9IDA7XHJcbiAgICAgICAgc291bmRCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcblxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VTb3VuZFZvbHVtZSgpIHtcclxuICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kQ29udHJvbC52YWx1ZSAvIDEwO1xyXG4gICAgaWYgKHZpZGVvLnZvbHVtZSA9PSAwKSB7XHJcbiAgICAgICAgc291bmRCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNvdW5kQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coJ9C30L3QsNGH0LXQvdC40LUgdm9sdW1lINGDINCy0LjQtNC10L4gJyArIHZpZGVvLnZvbHVtZSk7XHJcbiAgICBjb25zb2xlLmxvZygn0LfQvdCw0YfQtdC90LjQtSB2YWx1ZSDRgyBtaWNMZXZlbCAnICsgc291bmRDb250cm9sLnZhbHVlIC8gMTApO1xyXG59IiwiY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IChhbGlhcykgPT4ge1xyXG4gICAgcmV0dXJuICQoXCIucmV3aWV3c19faXRlbVwiKS5maWx0ZXIoKG5keCwgaXRlbSkgPT4ge1xyXG4gICAgICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtcIikgPT0gYWxpYXM7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbiQoXCIuaW50ZXJhY3RpdmUtYXZhdGFyXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCBjdXJyZW50ID0gJHRoaXMuYXR0cihcImRhdGEtb3BlblwiKTtcclxuICAgIGNvbnN0IGl0ZW1Ub1Nob3cgPSBmaW5kQmxvY2tCeUFsaWFzKGN1cnJlbnQpO1xyXG4gICAgY29uc3QgY3VySXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucmV3aWV3c19fc3dpdGNoZXItaXRlbVwiKTtcclxuXHJcbiAgICBpdGVtVG9TaG93LmFkZENsYXNzKFwicmV3aWV3c19faXRlbS0tYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJyZXdpZXdzX19pdGVtLS1hY3RpdmVcIik7XHJcbiAgICBjdXJJdGVtLmFkZENsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImludGVyYWN0aXZlLWF2YXRhci0tYWN0aXZlXCIpO1xyXG59KSIsImNvbnN0IHNsaWRlciA9ICQoXCIuc2xpZGVyX19saXN0XCIpLmJ4U2xpZGVyKHtcclxuICAgIHBhZ2VyOiBmYWxzZSxcclxuICAgIGNvbnRyb2xzOiBmYWxzZSxcclxufSk7XHJcblxyXG4kKFwiLnNsaWRlcl9fYnV0dG9uLS1wcmV2XCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBzbGlkZXIuZ29Ub1ByZXZTbGlkZSgpO1xyXG59KTtcclxuXHJcblxyXG4kKFwiLnNsaWRlcl9fYnV0dG9uLS1uZXh0XCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xyXG59KSIsImNvbnN0IG9wZW5JdGVtID0gaXRlbSA9PiB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIudGVhbV9faXRlbVwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnRCbG9jayA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2NvbnRlbnRcIik7XHJcbiAgICBjb25zdCB0ZXh0QmxvY2sgPSBjb250ZW50QmxvY2suZmluZChcIi50ZWFtX19jb250ZW50LWJsb2NrXCIpO1xyXG4gICAgY29uc3QgcmVxSGVpZ2h0ID0gdGV4dEJsb2NrLmhlaWdodCgpO1xyXG5cclxuICAgIGNvbnRhaW5lci5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgIGNvbnRlbnRCbG9jay5oZWlnaHQocmVxSGVpZ2h0KTtcclxufTtcclxuXHJcbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gY29udGFpbmVyID0+IHtcclxuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcclxuICAgIGNvbnN0IGl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pdGVtXCIpO1xyXG5cclxuICAgIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBpdGVtcy5oZWlnaHQoMCk7XHJcbn07XHJcblxyXG4kKFwiLnRlYW1fX25hbWVcIikuY2xpY2soZSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbVwiKTtcclxuICAgIGNvbnN0IGVsZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XHJcblxyXG4gICAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICAgIG9wZW5JdGVtKCR0aGlzKTtcclxuICAgIH1cclxuICAgIFxyXG59KTsiXX0=
