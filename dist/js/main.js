"use strict";var myMap,hamburger=document.querySelector(".hamburger"),menu=document.querySelector(".menu");hamburger.addEventListener("click",function(e){e.preventDefault(),menu.classList.toggle("menu--active"),hamburger.classList.toggle("hamburger--active")}),function(){function i(e){var t=e.find(".assortment-menu__item"),e=e.find(".assortment-menu__content");t.removeClass("active"),e.width(0)}function r(e){var t=0,n=$(window).width(),o=3*e.find(".assortment-menu__title").width(),a=e.find(".assortment-menu__container"),e=parseInt(a.css("padding-left")),a=parseInt(a.css("padding-right"));return{container:t=window.matchMedia("(max-width: 768px)").matches?n-o:500,textContainer:t-e-a}}$(".assortment-menu__title").click(function(e){e.preventDefault();var t=$(e.currentTarget),n=t.closest(".assortment-menu__item"),o=n.hasClass("active"),a=t.closest(".assortment-menu");o?i(a):(i(a),t=(e=n).find(".assortment-menu__content"),o=r(e).container,a=e.find(".assortment-menu__container"),n=r(e).textContainer,e.addClass("active"),t.width(o),a.width(n))}),$(".assortment-menu__close").click(function(e){e.preventDefault(),i($(".assortment-menu"))})}();var init=function(){myMap=new ymaps.Map("map",{center:[51.530777,46.035694],zoom:11,controls:[]});for(var e=[[51.550777,46.055694],[51.540777,46.075694],[51.530777,46.045694],[51.479213,46.085694]],t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/decor/marker.png",iconImageSize:[46,57],iconImageOffset:[-35,-52]}),n=0;n<e.length;n++)t.add(new ymaps.Placemark(e[n]));myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")};ymaps.ready(init);var validateForm=function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length};$(".form").submit(function(e){e.preventDefault();var t=$(e.currentTarget),n=t.find("[name='name']"),o=t.find("[name='phone']"),a=t.find("[name='comment']"),e=t.find("[name='to']"),i=$("#modal"),r=i.find(".modal__content");i.removeClass("error-modal"),validateForm(t,[n,o,a,e])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:n.val(),phone:o.val(),comment:a.val(),to:e.val()}})).done(function(e){r.text(e.message)}),e.fail(function(e){e=e.responseJSON.message;r.text(e),i.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".js-submit-btn").click(function(e){e.preventDefault(),$.fancybox.close()});var sections=$("section"),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1;sections.first().addClass("active");var durationControl,soundControl,intervalId,countSectionPosition=function(e){e*=-100;return isNaN(e)?(console.error("передано не верное значение в countSectionPosition"),0):e},changeMenuThemeForSection=function(e){var t="fixed-menu--shadowed";"black"===sections.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass(t):sideMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),resetActiveClassForItem(menuItems,e,"fixed-menu__item--active"),setTimeout(function(){inScroll=!1},1300))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}};$(window).on("wheel",function(e){var t=e.originalEvent.deltaY,e=viewportScroller();0<t&&e.next(),t<0&&e.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewportScroller();if(!t)switch(e.keyCode){case 38:n.prev();break;case 40:n.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"===t?"prev":"up"===t?"next":""]()}});var video,playBtn=document.querySelector(".video__player-img"),soundBtn=document.querySelector(".sound"),playerPlayBtn=document.querySelector(".duration__img");(video=document.getElementById("player")).addEventListener("click",playStop);for(var playButtons=document.querySelectorAll(".play"),i=0;i<playButtons.length;i++)playButtons[i].addEventListener("click",playStop);var micControl=document.getElementById("mic");function playStop(){playBtn.classList.toggle("video__player-img--active"),video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/60),playerPlayBtn.classList.add("active")):(video.pause(),clearInterval(intervalId),playerPlayBtn.classList.remove("active"))}function setVideoDuration(){video.currentTime=durationControl.value,updateDuration()}function updateDuration(){durationControl.value=video.currentTime;var e=video.duration/100,e=video.currentTime/e;durationControl.style.background="linear-gradient(90deg, #E01F3D 0%, #E01F3D ".concat(e,"%, #333333 ").concat(e,"%)")}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel,soundBtn.classList.remove("active")):(soundLevel=video.volume,video.volume=0,soundControl.value=0,soundBtn.classList.add("active"))}function changeSoundVolume(){video.volume=soundControl.value/10,0==video.volume?soundBtn.classList.add("active"):soundBtn.classList.remove("active"),console.log("значение volume у видео "+video.volume),console.log("значение value у micLevel "+soundControl.value/10)}micControl.addEventListener("click",soundOf),(durationControl=document.getElementById("durationLevel")).addEventListener("input",setVideoDuration),durationControl.min=0,durationControl.value=0,durationControl.max=video.duration,(soundControl=document.getElementById("micLevel")).addEventListener("input",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max,video.addEventListener("ended",function(){playBtn.classList.toggle("video__player-img--active"),video.currentTime=0,playerPlayBtn.classList.remove("active")});var findBlockByAlias=function(n){return $(".rewiews__item").filter(function(e,t){return $(t).attr("data-link")==n})};$(".interactive-avatar").click(function(e){e.preventDefault();var t=$(e.currentTarget),e=t.attr("data-open"),e=findBlockByAlias(e),t=t.closest(".rewiews__switcher-item");e.addClass("rewiews__item--active").siblings().removeClass("rewiews__item--active"),t.addClass("interactive-avatar--active").siblings().removeClass("interactive-avatar--active")});var slider=$(".slider__list").bxSlider({pager:!1,controls:!1});$(".slider__button--prev").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".slider__button--next").click(function(e){e.preventDefault(),slider.goToNextSlide()});var openItem=function(e){var t=e.closest(".team__item"),n=t.find(".team__content"),e=n.find(".team__content-block").height();t.addClass("active"),n.height(e)},closeEveryItem=function(e){var t=e.find(".team__content");e.find(".team__item").removeClass("active"),t.height(0)};$(".team__name").click(function(e){e.preventDefault();var t=$(e.currentTarget),e=t.closest(".team");t.closest(".team__item").hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZ1bGxzY3JlZW4tbWVudS5qcyIsIm1hcC5qcyIsImhvcml6b250YWwtYWNjby5qcyIsIm1vZGFsLmpzIiwib3BzLmpzIiwicGxheWVyLmpzIiwicmV3aWV3cy5qcyIsInNsaWRlci5qcyIsInRlYW0uanMiXSwibmFtZXMiOlsibXlNYXAiLCJoYW1idXJnZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIiLCJjb250YWluZXIiLCJpdGVtcyIsImZpbmQiLCJjb250ZW50IiwicmVtb3ZlQ2xhc3MiLCJ3aWR0aCIsIm1lYXN1cmVXaWR0aCIsImJsb2NrIiwiaXRlbVdpZHRoIiwic2NyZWVuV2lkdGgiLCIkIiwid2luZG93IiwidGl0bGVzV2lkdGgiLCJ0ZXh0Q29udGFpbmVyIiwicGFkZGluZ0xlZnQiLCJwYXJzZUludCIsImNzcyIsInBhZGRpbmdSaWdodCIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwiY2xpY2siLCIkdGhpcyIsImN1cnJlbnRUYXJnZXQiLCJpdGVtIiwiY2xvc2VzdCIsIml0ZW1PcGVuZWQiLCJoYXNDbGFzcyIsImhpZGRlbkJsb2NrIiwicmVxV2lkdGgiLCJ0ZXh0QmxvY2siLCJ0ZXh0QmxvY2tXaWR0aCIsImFkZENsYXNzIiwiaW5pdCIsInltYXBzIiwiTWFwIiwiY2VudGVyIiwiem9vbSIsImNvbnRyb2xzIiwiY29vcmRzIiwibXlDb2xsZWN0aW9uIiwiR2VvT2JqZWN0Q29sbGVjdGlvbiIsImRyYWdnYWJsZSIsImljb25MYXlvdXQiLCJpY29uSW1hZ2VIcmVmIiwiaWNvbkltYWdlU2l6ZSIsImljb25JbWFnZU9mZnNldCIsImkiLCJsZW5ndGgiLCJhZGQiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsInJlYWR5IiwidmFsaWRhdGVGb3JtIiwiZm9ybSIsImZpZWxkc0FycmF5IiwiZm9yRWFjaCIsImZpZWxkIiwidmFsIiwidHJpbSIsInN1Ym1pdCIsIm5hbWUiLCJwaG9uZSIsImNvbW1lbnQiLCJ0byIsIm1vZGFsIiwicmVxdWVzdCIsImFqYXgiLCJ1cmwiLCJtZXRob2QiLCJkYXRhIiwiZG9uZSIsInRleHQiLCJtZXNzYWdlIiwiZmFpbCIsInJlc3BvbnNlSlNPTiIsImFsd2F5cyIsImZhbmN5Ym94Iiwib3BlbiIsInNyYyIsInR5cGUiLCJjbG9zZSIsInNlY3Rpb25zIiwiZGlzcGxheSIsInNpZGVNZW51IiwibWVudUl0ZW1zIiwibW9iaWxlRGV0ZWN0IiwiTW9iaWxlRGV0ZWN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiaXNNb2JpbGUiLCJtb2JpbGUiLCJpblNjcm9sbCIsImZpcnN0IiwiZHVyYXRpb25Db250cm9sIiwic291bmRDb250cm9sIiwiaW50ZXJ2YWxJZCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwic2VjdGlvbkVxIiwicG9zaXRpb24iLCJpc05hTiIsImNvbnNvbGUiLCJlcnJvciIsImNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24iLCJhY3RpdmVDbGFzcyIsImVxIiwiYXR0ciIsInJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtIiwiaXRlbUVxIiwic2libGluZ3MiLCJwZXJmb3JtVHJhbnNpdGlvbiIsInRyYW5zZm9ybSIsImNvbmNhdCIsInNldFRpbWVvdXQiLCJ0cmFuc2l0aW9uT3ZlciIsInZpZXdwb3J0U2Nyb2xsZXIiLCJhY3RpdmVTZWN0aW9uIiwiZmlsdGVyIiwibmV4dFNlY3Rpb24iLCJuZXh0IiwicHJldlNlY3Rpb24iLCJwcmV2IiwiaW5kZXgiLCJvbiIsImRlbHRhWSIsIm9yaWdpbmFsRXZlbnQiLCJzY3JvbGxlciIsInRhZ05hbWUiLCJ0YXJnZXQiLCJ0b0xvd2VyQ2FzZSIsInVzZXJUeXBpbmdJbklucHV0cyIsImtleUNvZGUiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsImRpcmVjdGlvbiIsInZpZGVvIiwicGxheUJ0biIsInNvdW5kQnRuIiwicGxheWVyUGxheUJ0biIsImdldEVsZW1lbnRCeUlkIiwicGxheVN0b3AiLCJwbGF5QnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtaWNDb250cm9sIiwicGF1c2VkIiwicGxheSIsInNldEludGVydmFsIiwidXBkYXRlRHVyYXRpb24iLCJwYXVzZSIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmUiLCJzZXRWaWRlb0R1cmF0aW9uIiwiY3VycmVudFRpbWUiLCJ2YWx1ZSIsInN0ZXAiLCJkdXJhdGlvbiIsInBlcmNlbnQiLCJzdHlsZSIsImJhY2tncm91bmQiLCJzb3VuZE9mIiwidm9sdW1lIiwic291bmRMZXZlbCIsImNoYW5nZVNvdW5kVm9sdW1lIiwibG9nIiwibWluIiwibWF4IiwiZmluZEJsb2NrQnlBbGlhcyIsImFsaWFzIiwibmR4IiwiY3VycmVudCIsIml0ZW1Ub1Nob3ciLCJjdXJJdGVtIiwic2xpZGVyIiwiYnhTbGlkZXIiLCJwYWdlciIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwib3Blbkl0ZW0iLCJjb250ZW50QmxvY2siLCJyZXFIZWlnaHQiLCJoZWlnaHQiLCJjbG9zZUV2ZXJ5SXRlbSJdLCJtYXBwaW5ncyI6ImFBQUEsSUNBQUEsTURBQUMsVUFBQUMsU0FBQUMsY0FBQSxjQUNBQyxLQUFBRixTQUFBQyxjQUFBLFNBRUFGLFVBQUFJLGlCQUFBLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBVUFILEtBQUFJLFVBQUFDLE9BQUEsZ0JBQ0FSLFVBQUFPLFVBQUFDLE9BQUEsdUJFZkEsV0FDQSxTQUFBQyxFQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFFLEtBQUEsMEJBQ0FDLEVBQUFILEVBQUFFLEtBQUEsNkJBRUFELEVBQUFHLFlBQUEsVUFDQUQsRUFBQUUsTUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQSxFQUVBQyxFQUFBQyxFQUFBQyxRQUFBTixRQUNBTyxFQUFBLEVBQUFM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QUFBLFNBQUF2TCxHQUNBLElBQUFDLEVBQUFELEVBQUFFLEtBQUEsa0JBQ0FGLEVBQUFFLEtBQUEsZUFFQUUsWUFBQSxVQUNBSCxFQUFBcUwsT0FBQSxJQUdBNUssRUFBQSxlQUFBVSxNQUFBLFNBQUF6QixHQUNBQSxFQUFBQyxpQkFDQSxJQUFBeUIsRUFBQVgsRUFBQWYsRUFBQTJCLGVBQ0F0QixFQUFBcUIsRUFBQUcsUUFBQSxTQUNBSCxFQUFBRyxRQUFBLGVBRUFFLFNBQUEsVUFDQTZKLGVBQUF2TCxJQUVBdUwsZUFBQXZMLEdBQ0FtTCxTQUFBOUoiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGhhbWJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYW1idXJnZXInKTtcclxuY29uc3QgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudVwiKTtcclxuXHJcbmhhbWJ1cmdlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgLy8gaWYgKGhhbWJ1cmdlci5jbGFzc0xpc3QuY29udGFpbnMoXCJoYW1idXJnZXItLWFjdGl2ZVwiKSkge1xyXG4gICAgLy8gICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtLWFjdGl2ZVwiKTtcclxuICAgIC8vICAgICBoYW1idXJnZXIuY2xhc3NMaXN0LnJlbW92ZShcImhhbWJ1cmdlci0tYWN0aXZlXCIpO1xyXG4gICAgLy8gfSBlbHNlIHtcclxuICAgIC8vICAgICBtZW51LmNsYXNzTGlzdC5hZGQoXCJtZW51LS1hY3RpdmVcIik7XHJcbiAgICAvLyAgICAgaGFtYnVyZ2VyLmNsYXNzTGlzdC5hZGQoXCJoYW1idXJnZXItLWFjdGl2ZVwiKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICBtZW51LmNsYXNzTGlzdC50b2dnbGUoXCJtZW51LS1hY3RpdmVcIik7XHJcbiAgICBoYW1idXJnZXIuY2xhc3NMaXN0LnRvZ2dsZShcImhhbWJ1cmdlci0tYWN0aXZlXCIpO1xyXG59KTtcclxuIiwibGV0IG15TWFwO1xyXG5jb25zdCBpbml0ID0gKCkgPT4ge1xyXG4gICAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuICAgICAgICBjZW50ZXI6IFs1MS41MzA3NzcsIDQ2LjAzNTY5NF0sXHJcbiAgICAgICAgem9vbTogMTEsXHJcbiAgICAgICAgY29udHJvbHM6IFtdLFxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGNvb3JkcyA9IFtcclxuICAgICAgICBbNTEuNTUwNzc3LCA0Ni4wNTU2OTRdLFxyXG4gICAgICAgIFs1MS41NDA3NzcsIDQ2LjA3NTY5NF0sXHJcbiAgICAgICAgWzUxLjUzMDc3NywgNDYuMDQ1Njk0XSxcclxuICAgICAgICBbNTEuNDc5MjEzLCA0Ni4wODU2OTRdLFxyXG4gICAgXSxcclxuICAgICAgICBteUNvbGxlY3Rpb24gPSBuZXcgeW1hcHMuR2VvT2JqZWN0Q29sbGVjdGlvbih7fSwge1xyXG4gICAgICAgICAgICBkcmFnZ2FibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgICAgIGljb25JbWFnZUhyZWY6ICcuL2ltZy9kZWNvci9tYXJrZXIucG5nJyxcclxuICAgICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgICAgIGljb25JbWFnZU9mZnNldDogWy0zNSwgLTUyXVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3Jkc1tpXSkpO1xyXG4gICAgfVxyXG5cclxuICAgIG15TWFwLmdlb09iamVjdHMuYWRkKG15Q29sbGVjdGlvbik7XHJcblxyXG4gICAgbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKTtcclxufTtcclxuXHJcbnltYXBzLnJlYWR5KGluaXQpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciA9IChjb250YWluZXIpID0+IHtcclxuICAgICAgICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLmFzc29ydG1lbnQtbWVudV9faXRlbVwiKTtcclxuICAgICAgICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIuYXNzb3J0bWVudC1tZW51X19jb250ZW50XCIpO1xyXG5cclxuICAgICAgICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICBjb250ZW50LndpZHRoKDApO1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtZWFzdXJlV2lkdGggPSAoYmxvY2spID0+IHtcclxuICAgICAgICBsZXQgaXRlbVdpZHRoID0gMDtcclxuXHJcbiAgICAgICAgY29uc3Qgc2NyZWVuV2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcclxuICAgICAgICBjb25zdCB0aXRsZXNXaWR0aCA9IGJsb2NrLmZpbmQoXCIuYXNzb3J0bWVudC1tZW51X190aXRsZVwiKS53aWR0aCgpICogMztcclxuICAgICAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gYmxvY2suZmluZChcIi5hc3NvcnRtZW50LW1lbnVfX2NvbnRhaW5lclwiKTtcclxuICAgICAgICBjb25zdCBwYWRkaW5nTGVmdCA9IHBhcnNlSW50KHRleHRDb250YWluZXIuY3NzKFwicGFkZGluZy1sZWZ0XCIpKTtcclxuICAgICAgICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xyXG5cclxuICAgICAgICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpO1xyXG5cclxuICAgICAgICBpZiAoaXNNb2JpbGUubWF0Y2hlcykge1xyXG4gICAgICAgICAgICBpdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc1dpZHRoXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaXRlbVdpZHRoID0gNTAwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb250YWluZXI6IGl0ZW1XaWR0aCxcclxuICAgICAgICAgICAgdGV4dENvbnRhaW5lcjogaXRlbVdpZHRoIC0gcGFkZGluZ0xlZnQgLSBwYWRkaW5nUmlnaHRcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG9wZW5JdGVtID0gKGl0ZW0pID0+IHtcclxuICAgICAgICBjb25zdCBoaWRkZW5CbG9jayA9IGl0ZW0uZmluZChcIi5hc3NvcnRtZW50LW1lbnVfX2NvbnRlbnRcIik7XHJcbiAgICAgICAgY29uc3QgcmVxV2lkdGggPSBtZWFzdXJlV2lkdGgoaXRlbSkuY29udGFpbmVyO1xyXG4gICAgICAgIGNvbnN0IHRleHRCbG9jayA9IGl0ZW0uZmluZChcIi5hc3NvcnRtZW50LW1lbnVfX2NvbnRhaW5lclwiKTtcclxuICAgICAgICBjb25zdCB0ZXh0QmxvY2tXaWR0aCA9IG1lYXN1cmVXaWR0aChpdGVtKS50ZXh0Q29udGFpbmVyO1xyXG5cclxuICAgICAgICBpdGVtLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgIGhpZGRlbkJsb2NrLndpZHRoKHJlcVdpZHRoKTtcclxuICAgICAgICB0ZXh0QmxvY2sud2lkdGgodGV4dEJsb2NrV2lkdGgpXHJcbiAgICB9O1xyXG5cclxuICAgICQoXCIuYXNzb3J0bWVudC1tZW51X190aXRsZVwiKS5jbGljaygoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIuYXNzb3J0bWVudC1tZW51X19pdGVtXCIpO1xyXG4gICAgICAgIGNvbnN0IGl0ZW1PcGVuZWQgPSBpdGVtLmhhc0NsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIuYXNzb3J0bWVudC1tZW51XCIpO1xyXG5cclxuICAgICAgICBpZiAoaXRlbU9wZW5lZCkge1xyXG4gICAgICAgICAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpO1xyXG4gICAgICAgICAgICBvcGVuSXRlbShpdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKFwiLmFzc29ydG1lbnQtbWVudV9fY2xvc2VcIikuY2xpY2soKGUpID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoJCgnLmFzc29ydG1lbnQtbWVudScpKTtcclxuICAgIH0pO1xyXG59KCkpOyIsImNvbnN0IHZhbGlkYXRlRm9ybSA9IChmb3JtLCBmaWVsZHNBcnJheSkgPT4ge1xyXG5cclxuICAgIGZpZWxkc0FycmF5LmZvckVhY2goKGZpZWxkKSA9PiB7XHJcbiAgICAgICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgICAgICBpZiAoZmllbGQudmFsKCkudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBlcnJvckZpZWxkID0gZm9ybS5maW5kKFwiLmlucHV0LWVycm9yXCIpO1xyXG5cclxuICAgIHJldHVybiBlcnJvckZpZWxkLmxlbmd0aCA9PSAwO1xyXG59XHJcblxyXG4kKFwiLmZvcm1cIikuc3VibWl0KGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHJcbiAgICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XHJcbiAgICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xyXG4gICAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XHJcbiAgICBjb25zdCB0byA9IGZvcm0uZmluZChcIltuYW1lPSd0byddXCIpO1xyXG5cclxuICAgIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5maW5kKFwiLm1vZGFsX19jb250ZW50XCIpO1xyXG5cclxuICAgIG1vZGFsLnJlbW92ZUNsYXNzKFwiZXJyb3ItbW9kYWxcIik7XHJcblxyXG4gICAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRm9ybShmb3JtLCBbbmFtZSwgcGhvbmUsIGNvbW1lbnQsIHRvXSk7XHJcblxyXG5cclxuXHJcbiAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUudmFsKCksXHJcbiAgICAgICAgICAgICAgICBwaG9uZTogcGhvbmUudmFsKCksXHJcbiAgICAgICAgICAgICAgICBjb21tZW50OiBjb21tZW50LnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgdG86IHRvLnZhbCgpLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXF1ZXN0LmRvbmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgIGNvbnRlbnQudGV4dChtZXNzYWdlKTtcclxuICAgICAgICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmVxdWVzdC5hbHdheXMoKCkgPT4ge1xyXG4gICAgICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJpbmxpbmVcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuJChcIi5qcy1zdWJtaXQtYnRuXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgJC5mYW5jeWJveC5jbG9zZSgpO1xyXG59KTsiLCJjb25zdCBzZWN0aW9ucyA9ICQoXCJzZWN0aW9uXCIpO1xyXG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluY29udGVudFwiKTtcclxuY29uc3Qgc2lkZU1lbnUgPSAkKFwiLmZpeGVkLW1lbnVcIik7XHJcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcclxuXHJcbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcbmxldCBpblNjcm9sbCA9IGZhbHNlO1xyXG5cclxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuXHJcbmNvbnN0IGNvdW50U2VjdGlvblBvc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gICAgY29uc3QgcG9zaXRpb24gPSBzZWN0aW9uRXEgKiAtMTAwO1xyXG5cclxuICAgIGlmIChpc05hTihwb3NpdGlvbikpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwi0L/QtdGA0LXQtNCw0L3QviDQvdC1INCy0LXRgNC90L7QtSDQt9C90LDRh9C10L3QuNC1INCyIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpO1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwb3NpdGlvbjtcclxufTtcclxuXHJcbmNvbnN0IGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb25zLmVxKHNlY3Rpb25FcSk7XHJcbiAgICBjb25zdCBtZW51VGhlbWUgPSBjdXJyZW50U2VjdGlvbi5hdHRyKFwiZGF0YS1zaWRlbWVudS10aGVtZVwiKTtcclxuICAgIGNvbnN0IGFjdGl2ZUNsYXNzID0gXCJmaXhlZC1tZW51LS1zaGFkb3dlZFwiO1xyXG5cclxuICAgIGlmIChtZW51VGhlbWUgPT09IFwiYmxhY2tcIikge1xyXG4gICAgICAgIHNpZGVNZW51LmFkZENsYXNzKGFjdGl2ZUNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc2lkZU1lbnUucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcclxuICAgIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgcGVyZm9ybVRyYW5zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgICBpZiAoaW5TY3JvbGwpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XHJcbiAgICBjb25zdCBtb3VzZUluZXJ0aWFPdmVyID0gMzAwO1xyXG5cclxuICAgIGluU2Nyb2xsID0gdHJ1ZTtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbihzZWN0aW9uRXEpO1xyXG5cclxuICAgIGRpc3BsYXkuY3NzKHtcclxuICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcbiAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgaW5TY3JvbGwgPSBmYWxzZTtcclxuICAgIH0sIHRyYW5zaXRpb25PdmVyICsgbW91c2VJbmVydGlhT3Zlcik7XHJcbn07XHJcblxyXG5jb25zdCB2aWV3cG9ydFNjcm9sbGVyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb25zLmZpbHRlcihcIi5hY3RpdmVcIik7XHJcbiAgICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xyXG4gICAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQoKSB7XHJcbiAgICAgICAgICAgIGlmIChuZXh0U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHBlcmZvcm1UcmFuc2l0aW9uKG5leHRTZWN0aW9uLmluZGV4KCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcmV2KCkge1xyXG4gICAgICAgICAgICBpZiAocHJldlNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG59O1xyXG5cclxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgKGUpID0+IHtcclxuICAgIGNvbnN0IGRlbHRhWSA9IGUub3JpZ2luYWxFdmVudC5kZWx0YVk7XHJcbiAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgICBpZiAoZGVsdGFZID4gMCkge1xyXG4gICAgICAgIHNjcm9sbGVyLm5leHQoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZGVsdGFZIDwgMCkge1xyXG4gICAgICAgIHNjcm9sbGVyLnByZXYoKTtcclxuICAgIH1cclxufSk7XHJcblxyXG4kKHdpbmRvdykub24oXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgdXNlclR5cGluZ0luSW5wdXRzID0gdGFnTmFtZSA9PT0gXCJpbnB1dFwiIHx8IHRhZ05hbWUgPT09IFwidGV4dGFyZWFcIjtcclxuICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuICAgIGlmICh1c2VyVHlwaW5nSW5JbnB1dHMpIHJldHVybjtcclxuXHJcbiAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xyXG4gICAgICAgIGNhc2UgMzg6XHJcbiAgICAgICAgICAgIHNjcm9sbGVyLnByZXYoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgNDA6XHJcbiAgICAgICAgICAgIHNjcm9sbGVyLm5leHQoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuJChcIi53cmFwcGVyXCIpLm9uKFwidG91Y2htb3ZlXCIsIChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG5cclxuJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcclxuICAgIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcclxuXHJcbiAgICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xyXG59KTtcclxuXHJcbmlmIChpc01vYmlsZSkge1xyXG4gICAgJChcImJvZHlcIikuc3dpcGUoe1xyXG4gICAgICAgIHN3aXBlOiBmdW5jdGlvbiAoZXZlbnQsIGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuICAgICAgICAgICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBcImRvd25cIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7XHJcblxyXG4gICAgICAgICAgICBzY3JvbGxlcltzY3JvbGxEaXJlY3Rpb25dKCk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG59IiwibGV0IHZpZGVvO1xyXG5sZXQgZHVyYXRpb25Db250cm9sO1xyXG5sZXQgc291bmRDb250cm9sO1xyXG5sZXQgaW50ZXJ2YWxJZDtcclxuXHJcbmNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpZGVvX19wbGF5ZXItaW1nXCIpO1xyXG5jb25zdCBzb3VuZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc291bmRcIik7XHJcbmNvbnN0IHBsYXllclBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmR1cmF0aW9uX19pbWdcIik7XHJcblxyXG5cclxudmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuXHJcblxyXG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlTdG9wKTtcclxuXHJcbmxldCBwbGF5QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucGxheVwiKTtcclxuZm9yIChsZXQgaSA9IDA7IGkgPCBwbGF5QnV0dG9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgcGxheUJ1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5U3RvcCk7XHJcbn1cclxuXHJcbmxldCBtaWNDb250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtaWNcIik7XHJcbm1pY0NvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzb3VuZE9mKTtcclxuXHJcbmR1cmF0aW9uQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZHVyYXRpb25MZXZlbFwiKTtcclxuZHVyYXRpb25Db250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgc2V0VmlkZW9EdXJhdGlvbik7XHJcblxyXG5kdXJhdGlvbkNvbnRyb2wubWluID0gMDtcclxuZHVyYXRpb25Db250cm9sLnZhbHVlID0gMDtcclxuZHVyYXRpb25Db250cm9sLm1heCA9IHZpZGVvLmR1cmF0aW9uO1xyXG5cclxuc291bmRDb250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtaWNMZXZlbFwiKTtcclxuc291bmRDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgY2hhbmdlU291bmRWb2x1bWUpO1xyXG5cclxuc291bmRDb250cm9sLm1pbiA9IDA7XHJcbnNvdW5kQ29udHJvbC5tYXggPSAxMDtcclxuc291bmRDb250cm9sLnZhbHVlID0gc291bmRDb250cm9sLm1heDtcclxuXHJcblxyXG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHBsYXlCdG4uY2xhc3NMaXN0LnRvZ2dsZShcInZpZGVvX19wbGF5ZXItaW1nLS1hY3RpdmVcIik7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbiAgICBwbGF5ZXJQbGF5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG59KTtcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gcGxheVN0b3AoKSB7XHJcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJ2aWRlb19fcGxheWVyLWltZy0tYWN0aXZlXCIpO1xyXG5cclxuXHJcbiAgICBpZiAodmlkZW8ucGF1c2VkKSB7XHJcbiAgICAgICAgdmlkZW8ucGxheSgpO1xyXG4gICAgICAgIGludGVydmFsSWQgPSBzZXRJbnRlcnZhbCh1cGRhdGVEdXJhdGlvbiwgMTAwMCAvIDYwKTtcclxuICAgICAgICBwbGF5ZXJQbGF5QnRuLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XHJcbiAgICAgICAgcGxheWVyUGxheUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0VmlkZW9EdXJhdGlvbigpIHtcclxuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gZHVyYXRpb25Db250cm9sLnZhbHVlO1xyXG4gICAgdXBkYXRlRHVyYXRpb24oKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUR1cmF0aW9uKCkge1xyXG4gICAgZHVyYXRpb25Db250cm9sLnZhbHVlID0gdmlkZW8uY3VycmVudFRpbWU7XHJcbiAgICBsZXQgc3RlcCA9IHZpZGVvLmR1cmF0aW9uIC8gMTAwO1xyXG4gICAgbGV0IHBlcmNlbnQgPSB2aWRlby5jdXJyZW50VGltZSAvIHN0ZXA7XHJcbiAgICBkdXJhdGlvbkNvbnRyb2wuc3R5bGUuYmFja2dyb3VuZCA9IGBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICNFMDFGM0QgMCUsICNFMDFGM0QgJHtwZXJjZW50fSUsICMzMzMzMzMgJHtwZXJjZW50fSUpYDtcclxuXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBzb3VuZE9mKCkge1xyXG4gICAgaWYgKHZpZGVvLnZvbHVtZSA9PT0gMCkge1xyXG4gICAgICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kTGV2ZWw7XHJcbiAgICAgICAgc291bmRDb250cm9sLnZhbHVlID0gc291bmRMZXZlbCAqIDEwO1xyXG4gICAgICAgIHNvdW5kQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzb3VuZExldmVsID0gdmlkZW8udm9sdW1lO1xyXG4gICAgICAgIHZpZGVvLnZvbHVtZSA9IDA7XHJcbiAgICAgICAgc291bmRDb250cm9sLnZhbHVlID0gMDtcclxuICAgICAgICBzb3VuZEJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVNvdW5kVm9sdW1lKCkge1xyXG4gICAgdmlkZW8udm9sdW1lID0gc291bmRDb250cm9sLnZhbHVlIC8gMTA7XHJcbiAgICBpZiAodmlkZW8udm9sdW1lID09IDApIHtcclxuICAgICAgICBzb3VuZEJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgc291bmRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZygn0LfQvdCw0YfQtdC90LjQtSB2b2x1bWUg0YMg0LLQuNC00LXQviAnICsgdmlkZW8udm9sdW1lKTtcclxuICAgIGNvbnNvbGUubG9nKCfQt9C90LDRh9C10L3QuNC1IHZhbHVlINGDIG1pY0xldmVsICcgKyBzb3VuZENvbnRyb2wudmFsdWUgLyAxMCk7XHJcbn0iLCJjb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gKGFsaWFzKSA9PiB7XHJcbiAgICByZXR1cm4gJChcIi5yZXdpZXdzX19pdGVtXCIpLmZpbHRlcigobmR4LCBpdGVtKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQoaXRlbSkuYXR0cihcImRhdGEtbGlua1wiKSA9PSBhbGlhcztcclxuICAgIH0pO1xyXG59O1xyXG5cclxuJChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJcIikuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IGN1cnJlbnQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xyXG4gICAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXMoY3VycmVudCk7XHJcbiAgICBjb25zdCBjdXJJdGVtID0gJHRoaXMuY2xvc2VzdChcIi5yZXdpZXdzX19zd2l0Y2hlci1pdGVtXCIpO1xyXG5cclxuICAgIGl0ZW1Ub1Nob3cuYWRkQ2xhc3MoXCJyZXdpZXdzX19pdGVtLS1hY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcInJld2lld3NfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuICAgIGN1ckl0ZW0uYWRkQ2xhc3MoXCJpbnRlcmFjdGl2ZS1hdmF0YXItLWFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIik7XHJcbn0pIiwiY29uc3Qgc2xpZGVyID0gJChcIi5zbGlkZXJfX2xpc3RcIikuYnhTbGlkZXIoe1xyXG4gICAgcGFnZXI6IGZhbHNlLFxyXG4gICAgY29udHJvbHM6IGZhbHNlLFxyXG59KTtcclxuXHJcbiQoXCIuc2xpZGVyX19idXR0b24tLXByZXZcIikuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHNsaWRlci5nb1RvUHJldlNsaWRlKCk7XHJcbn0pO1xyXG5cclxuXHJcbiQoXCIuc2xpZGVyX19idXR0b24tLW5leHRcIikuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHNsaWRlci5nb1RvTmV4dFNsaWRlKCk7XHJcbn0pIiwiY29uc3Qgb3Blbkl0ZW0gPSBpdGVtID0+IHtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xyXG4gICAgY29uc3QgY29udGVudEJsb2NrID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcclxuICAgIGNvbnN0IHRleHRCbG9jayA9IGNvbnRlbnRCbG9jay5maW5kKFwiLnRlYW1fX2NvbnRlbnQtYmxvY2tcIik7XHJcbiAgICBjb25zdCByZXFIZWlnaHQgPSB0ZXh0QmxvY2suaGVpZ2h0KCk7XHJcblxyXG4gICAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgY29udGVudEJsb2NrLmhlaWdodChyZXFIZWlnaHQpO1xyXG59O1xyXG5cclxuY29uc3QgY2xvc2VFdmVyeUl0ZW0gPSBjb250YWluZXIgPT4ge1xyXG4gICAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19jb250ZW50XCIpO1xyXG4gICAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2l0ZW1cIik7XHJcblxyXG4gICAgaXRlbUNvbnRhaW5lci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgIGl0ZW1zLmhlaWdodCgwKTtcclxufTtcclxuXHJcbiQoXCIudGVhbV9fbmFtZVwiKS5jbGljayhlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi50ZWFtXCIpO1xyXG4gICAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbV9faXRlbVwiKTtcclxuXHJcbiAgICBpZiAoZWxlbUNvbnRhaW5lci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICBjbG9zZUV2ZXJ5SXRlbShjb250YWluZXIpO1xyXG4gICAgb3Blbkl0ZW0oJHRoaXMpO1xyXG4gICAgfVxyXG4gICAgXHJcbn0pOyJdfQ==
